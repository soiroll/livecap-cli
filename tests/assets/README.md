# Test assets

This directory holds lightweight audio fixtures plus optional source corpora used to generate them.

## Layout

```
tests/assets/
├── audio/                    # git-tracked (quick mode, few files)
│   ├── ja/                   # Japanese audio files
│   │   ├── jsut_basic5000_0001.wav
│   │   └── jsut_basic5000_0001.txt
│   ├── en/                   # English audio files
│   │   ├── librispeech_1089-134686-0001.wav
│   │   └── librispeech_1089-134686-0001.txt
│   └── common/               # Language-independent test files
│       └── test_tone_1s.mkv
│
├── prepared/                 # git-ignored (generated by conversion script)
│   ├── ja/                   # Converted Japanese data
│   └── en/                   # Converted English data
│
├── source/                   # git-ignored (source corpora)
│   ├── jsut/jsut_ver1.1/     # JSUT v1.1 (~3.4GB)
│   └── librispeech/test-clean/  # LibriSpeech test-clean (~358MB)
│
└── README.md
```

## Naming Convention (tracked clips)

- `{lang}/{corpus}_{subset}_{utterance}.wav` (and same stem for `.txt` transcripts)
- Examples:
  - `ja/jsut_basic5000_0001.wav`
  - `en/librispeech_1089-134686-0001.wav`

## Transcript format

- UTF-8 plain text, single line, trailing newline
- Content mirrors the source corpus text as-is:
  - LibriSpeech: uppercase, original punctuation
  - JSUT: original Japanese punctuation
- No extra quoting or metadata in the `.txt`. If metadata is needed later, add a parallel `<stem>.meta.json` instead.

## Execution Modes

| Mode | Data Source | Files per Language | Use Case |
|------|-------------|-------------------|----------|
| `quick` | `audio/` | 2 | CI smoke tests |
| `standard` | `prepared/` | 100 (adjustable) | Local development |
| `full` | `prepared/` | All files | Full benchmarks |

## Source Corpora

Source corpora should be placed under `tests/assets/source/` (git-ignored):

- `tests/assets/source/jsut/jsut_ver1.1/` — JSUT v1.1 (https://sites.google.com/site/shinnosuketakamichi/publication/jsut)
- `tests/assets/source/librispeech/test-clean/` — LibriSpeech test-clean (https://www.openslr.org/12)

## Generation & Normalization

Target specifications:
- Duration: 3–8 seconds
- Format: 16 kHz mono WAV
- Peak: around -1 dBFS
- Padding: ~0.2–0.3 s of leading/trailing silence

Example commands:

```bash
# LibriSpeech (FLAC → WAV)
ffmpeg -i tests/assets/source/librispeech/test-clean/LibriSpeech/test-clean/1089/134686/1089-134686-0001.flac \
  -ss 0 -t 4 -ac 1 -ar 16000 -af "volume=-1dB" \
  tests/assets/audio/en/librispeech_1089-134686-0001.wav

# JSUT (WAV → normalized WAV)
ffmpeg -i tests/assets/source/jsut/jsut_ver1.1/basic5000/wav/BASIC5000_0001.wav \
  -ss 0 -t 6 -ac 1 -ar 16000 -af "volume=-1dB" \
  tests/assets/audio/ja/jsut_basic5000_0001.wav
```

## Conversion Script

For `standard` and `full` modes, use the conversion script to generate `prepared/` data:

```bash
# Standard mode (100 files per language)
python scripts/prepare_benchmark_data.py --mode standard

# Full mode (all files)
python scripts/prepare_benchmark_data.py --mode full

# Custom limits
python scripts/prepare_benchmark_data.py --ja-limit 500 --en-limit 200
```

## Optional Environment Variables

- `LIVECAP_LIBRISPEECH_DIR` and `LIVECAP_JSUT_DIR` can point to larger local corpora for benchmark-style tests
- Tests should skip gracefully when these are absent

## Licensing and Attribution

### LibriSpeech test-clean
- License: CC BY 4.0 (https://creativecommons.org/licenses/by/4.0/)
- Source: https://www.openslr.org/12
- Commercial use: permitted

### JSUT v1.1
- License: research / non-commercial only
- Source: https://sites.google.com/site/shinnosuketakamichi/publication/jsut
- Commercial use: requires separate permission

Derived short clips in `tests/assets/audio/` inherit the licenses of their source corpora. Use only for development/CI; provide alternative fixtures or obtain permission for commercial deployments.
